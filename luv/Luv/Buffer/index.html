<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Buffer (luv.Luv.Buffer)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">luv</a> &#x00BB; <a href="../index.html">Luv</a> &#x00BB; Buffer</nav><header class="odoc-preamble"><h1>Module <code><span>Luv.Buffer</span></code></h1><p>Data buffers.</p><p>See <a href="../../../basics.html#buffers"><i>Buffers</i></a> in the user guide.</p></header><nav class="odoc-toc"><ul><li><a href="#basics">Basics</a></li><li><a href="#conversions">Conversions</a></li><li><a href="#converting-blits">Converting blits</a></li><li><a href="#lists-of-buffers">Lists of buffers</a></li></ul></nav><div class="odoc-content"><h2 id="basics"><a href="#basics" class="anchor"></a>Basics</h2><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> =
  <span><span>(char, <span class="xref-unresolved">Stdlib</span>.Bigarray.int8_unsigned_elt, <span class="xref-unresolved">Stdlib</span>.Bigarray.c_layout)</span>
    <span class="xref-unresolved">Stdlib</span>.Bigarray.Array1.t</span></span></code></div><div class="spec-doc"><p>Buffers with C storage.</p><p>These are OCaml bigstrings (<code>char</code> bigarrays). Roughly speaking, they correspond to C buffers referenced by pointers of type <code>char*</code>, but also know their own size.</p><p>In addition to being usable with the functions in this module, the type is compatible with at least the following libraries:</p><ul><li><a href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Bigarray.Array1.html"><code>Bigarray</code></a> from OCaml's standard library</li><li><a href="https://ocsigen.org/lwt/dev/api/Lwt_bytes"><code>Lwt_bytes</code></a> from Lwt</li><li><a href="https://github.com/inhabitedtype/bigstringaf">bigstringaf</a></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Allocates a fresh buffer of the given size.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-size"><a href="#val-size" class="anchor"></a><code><span><span class="keyword">val</span> size : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Evaluates to the size of the given buffer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> char</span></code></div><div class="spec-doc"><p><code>Luv.Buffer.get buffer index</code> retrieves the character in <code>buffer</code> at <code>index</code>.</p><p>Can also be written as <code>buffer.{index}</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unsafe_get"><a href="#val-unsafe_get" class="anchor"></a><code><span><span class="keyword">val</span> unsafe_get : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> char</span></code></div><div class="spec-doc"><p>Like <a href="#val-get"><code>Luv.Buffer.get</code></a>, but does not perform a bounds check.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>char <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>Luv.Buffer.set buffer index value</code> sets the character in <code>buffer</code> at <code>index</code> to <code>value</code>.</p><p>Can also be written as <code>buffer.{index} &lt;- value</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unsafe_set"><a href="#val-unsafe_set" class="anchor"></a><code><span><span class="keyword">val</span> unsafe_set : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>char <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Like <a href="#val-set"><code>Luv.Buffer.set</code></a>, but does not perform a bounds check.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sub"><a href="#val-sub" class="anchor"></a><code><span><span class="keyword">val</span> sub : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">offset</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="label">length</span>:int <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>Luv.Buffer.sub buffer ~offset ~length</code> creates a view into <code>buffer</code> that starts at the given offset and has the given length.</p><p>No data is copied.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-blit"><a href="#val-blit" class="anchor"></a><code><span><span class="keyword">val</span> blit : <span><span class="label">source</span>:<a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">destination</span>:<a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Copies data from <code>source</code> to <code>destination</code>.</p><p>The amount of data copied is the minimum of the two buffers' size.</p><p>To copy part of a buffer, use <a href="#val-sub"><code>Luv.Buffer.sub</code></a> to create a view, and pass the view to <code>Luv.Buffer.blit</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fill"><a href="#val-fill" class="anchor"></a><code><span><span class="keyword">val</span> fill : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>char <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Fills the given buffer with the given character.</p></div></div><h2 id="conversions"><a href="#conversions" class="anchor"></a>Conversions</h2><div class="odoc-spec"><div class="spec value anchored" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span><span class="keyword">val</span> to_string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Creates a string with the same contents as the given buffer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_bytes"><a href="#val-to_bytes" class="anchor"></a><code><span><span class="keyword">val</span> to_bytes : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bytes</span></code></div><div class="spec-doc"><p>Creates a <code>bytes</code> buffer with the same contents as the given buffer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-from_string"><a href="#val-from_string" class="anchor"></a><code><span><span class="keyword">val</span> from_string : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Creates a buffer from a string.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-from_bytes"><a href="#val-from_bytes" class="anchor"></a><code><span><span class="keyword">val</span> from_bytes : <span>bytes <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Creates a buffer from <code>bytes</code>.</p></div></div><h2 id="converting-blits"><a href="#converting-blits" class="anchor"></a>Converting blits</h2><div class="odoc-spec"><div class="spec value anchored" id="val-blit_to_bytes"><a href="#val-blit_to_bytes" class="anchor"></a><code><span><span class="keyword">val</span> blit_to_bytes : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>bytes <span class="arrow">&#45;&gt;</span></span> <span><span class="label">destination_offset</span>:int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Copies data from a buffer to a <code>bytes</code> buffer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-blit_from_bytes"><a href="#val-blit_from_bytes" class="anchor"></a><code><span><span class="keyword">val</span> blit_from_bytes : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>bytes <span class="arrow">&#45;&gt;</span></span> <span><span class="label">source_offset</span>:int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Copies data from a <code>bytes</code> buffer to a buffer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-blit_from_string"><a href="#val-blit_from_string" class="anchor"></a><code><span><span class="keyword">val</span> blit_from_string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">source_offset</span>:int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Copies data from a string to a buffer.</p></div></div><h2 id="lists-of-buffers"><a href="#lists-of-buffers" class="anchor"></a>Lists of buffers</h2><p>Many Luv functions, such as <a href="../File/index.html#val-write"><code>Luv.File.write</code></a>, work with lists of buffers (i.e., they do scatter-gather I/O). These are helpers for working with buffer lists.</p><div class="odoc-spec"><div class="spec value anchored" id="val-total_size"><a href="#val-total_size" class="anchor"></a><code><span><span class="keyword">val</span> total_size : <span><span><a href="#type-t">t</a> list</span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Evaluates to the sum of the sizes of the buffers in the list.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-drop"><a href="#val-drop" class="anchor"></a><code><span><span class="keyword">val</span> drop : <span><span><a href="#type-t">t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> list</span></span></code></div><div class="spec-doc"><p><code>drop buffers count</code> drops the first <code>count</code> bytes from <code>buffers</code>.</p><p>For example, if <code>buffers</code> contains two buffers of size 16, <code>drop buffers
    18</code> will evaluate to a list that has lost the reference to the first buffer, and contains only a view into the second buffer of size 14.</p></div></div></div></body></html>
